<!DOCTYPE html>
<html>
<head>
  <title>Firewall Frenzy</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: "Segoe UI", Arial, sans-serif;
      color: #e6e6e6;
      background: #000;
      text-align: center;
    }

    #canvasBG {
      position: fixed;
      top: 0;
      left: 0;
      z-index: -1;
    }

    #game {
      position: relative;
      background: rgba(10, 25, 47, 0.95);
      width: 450px;
      margin: 60px auto;
      padding: 25px;
      border-radius: 12px;
      border: 1px solid #1f4068;
      box-shadow: 0 0 25px rgba(0, 255, 180, 0.15);
      z-index: 1;
    }

    h1 { letter-spacing: 2px; color: #00ffb3; margin-bottom: 10px; }
    #threat { font-size: 18px; margin: 20px 0; padding: 12px; border: 1px dashed #00ffb3; border-radius: 6px; transition: background-color 0.2s; }
    button { font-size: 16px; padding: 12px 22px; margin: 8px; cursor: pointer; border-radius: 6px; border: none; font-weight: bold; letter-spacing: 1px; transition: 0.2s; }
    button:hover { transform: scale(1.05); }
    #blockBtn { background: #ff4c4c; color: white; }
    #allowBtn { background: #00ffb3; color: #022; }
    #startBtn { background: #1f4068; color: white; }
    #musicBtn { background: #22b14c; color: #000; }
    hr { margin: 20px 0; border-color: #00ffb3; }
    #scoreboard { list-style: none; padding: 0; text-align: left; max-width: 220px; margin: 0 auto; }
    #scoreboard li { padding: 4px 0; }
  </style>
</head>
<body>

<canvas id="canvasBG"></canvas>

<div id="game">
  <h1>Firewall Frenzy</h1>

  <p id="threat">Press START to begin</p>

  <button id="blockBtn" onclick="block()">BLOCK</button>
  <button id="allowBtn" onclick="allow()">ALLOW</button>

  <p>Score: <span id="score">0</span></p>
  <p>Lives: <span id="lives">3</span></p>

  <button id="startBtn" onclick="startGame()">START</button>
  <button id="musicBtn" onclick="toggleMusic()">Toggle Music</button>

  <hr>
  <h3>Scoreboard</h3>
  <ul id="scoreboard"></ul>
</div>

<!-- Audio -->
<audio id="bgMusic" loop>
  <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
</audio>
<audio id="correctSound">
  <source src="https://www.soundjay.com/button/sounds/button-10.mp3" type="audio/mpeg">
</audio>
<audio id="wrongSound">
  <source src="https://www.soundjay.com/button/sounds/button-09.mp3" type="audio/mpeg">
</audio>

<script>
let threats = [
  { text: "Email from unknown sender with an attachment", correct: "block" },
  { text: "Software update from official company website", correct: "allow" },
  { text: "Pop-up saying you won a free phone", correct: "block" },
  { text: "Secure HTTPS login page for your bank", correct: "allow" },
  { text: "Link asking you to reset password urgently", correct: "block" },
  { text: "Company email with internal meeting invite", correct: "allow" },
  { text: "USB drive found and plugged into computer", correct: "block" },
  { text: "Two-factor authentication code request", correct: "allow" },
  { text: "Download link from unknown forum", correct: "block" },
  { text: "Official app downloaded from app store", correct: "allow" },
  { text: "Email claiming your account is locked", correct: "block" },
  { text: "Cloud backup sync from trusted service", correct: "allow" },
  { text: "Fake antivirus warning pop-up", correct: "block" },
  { text: "Secure Wi-Fi network with password", correct: "allow" },
  { text: "Message asking for personal details", correct: "block" },
  { text: "Verified payment confirmation email", correct: "allow" },
  { text: "Website asking for credit card details unexpectedly", correct: "block" },
  { text: "System notification from operating system", correct: "allow" },
  { text: "QR code from unknown source", correct: "block" },
  { text: "Trusted website with valid security certificate", correct: "allow" }
];

let score = 0;
let current = 0;
let lives = 3;
let timer;
let timeLeft = 3;
let musicPlaying = true;

// Shuffle array
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    let j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
}

// Save/load scores
function saveScore(name, score) {
  let scores = JSON.parse(localStorage.getItem("firewallScores")) || [];
  scores.push({ name: name, score: score });
  scores.sort((a,b) => b.score - a.score);
  scores = scores.slice(0,5);
  localStorage.setItem("firewallScores", JSON.stringify(scores));
}

function loadScores() {
  let scores = JSON.parse(localStorage.getItem("firewallScores")) || [];
  let list = document.getElementById("scoreboard");
  list.innerHTML = "";
  scores.forEach(entry => {
    let li = document.createElement("li");
    li.innerText = entry.name + " â€” " + entry.score;
    list.appendChild(li);
  });
}

// Music toggle
function toggleMusic() {
  let music = document.getElementById("bgMusic");
  if (musicPlaying) {
    music.pause();
    musicPlaying = false;
  } else {
    music.play();
    musicPlaying = true;
  }
}

// Game logic
function startGame() {
  score = 0; current = 0; lives = 3;
  document.getElementById("score").innerText = score;
  document.getElementById("lives").innerText = lives;
  shuffle(threats);
  if (musicPlaying) document.getElementById("bgMusic").play();
  nextThreat();
}

function nextThreat() {
  clearInterval(timer);
  if (current >= threats.length || lives <= 0) {
    if (score >= 10) {
      alert("You are safe!");
      let name = prompt("Enter your name to save your score:");
      if (name) saveScore(name, score);
    } else {
      alert("Try again!");
    }
    loadScores();
    return;
  }
  timeLeft = 3;
  updateThreatText();
  timer = setInterval(countdown, 1000);
}

function updateThreatText() {
  document.getElementById("threat").innerText =
    threats[current].text + " (" + timeLeft + "s)";
}

function countdown() {
  timeLeft--;
  updateThreatText();
  if (timeLeft <= 0) {
    clearInterval(timer);
    lives--;
    document.getElementById("lives").innerText = lives;
    current++;
    nextThreat();
  }
}

function block() { checkAnswer("block"); }
function allow() { checkAnswer("allow"); }

function checkAnswer(choice) {
  clearInterval(timer);
  if (choice === threats[current].correct) {
    score++;
    document.getElementById("score").innerText = score;
    document.getElementById("correctSound").play();
    document.getElementById("threat").style.backgroundColor = "#00ffb3";
  } else {
    lives--;
    document.getElementById("lives").innerText = lives;
    document.getElementById("wrongSound").play();
    document.getElementById("threat").style.backgroundColor = "#ff4c4c";
  }
  setTimeout(() => { document.getElementById("threat").style.backgroundColor = ""; }, 300);
  current++;
  nextThreat();
}

// Load scoreboard initially
loadScores();

// Cyber code background
const canvas = document.getElementById("canvasBG");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const letters = '01';
const fontSize = 16;
const columns = canvas.width / fontSize;
const drops = [];
for (let x = 0; x < columns; x++) drops[x] = Math.floor(Math.random() * canvas.height/fontSize);

function draw() {
  ctx.fillStyle = "rgba(0,0,0,0.05)";
  ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle = "#0f0";
  ctx.font = fontSize + "px monospace";
  for (let i = 0; i < drops.length; i++) {
    const text = letters[Math.floor(Math.random() * letters.length)];
    ctx.fillText(text, i*fontSize, drops[i]*fontSize);
    if (drops[i]*fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0;
    drops[i]++;
  }
}

setInterval(draw, 50);

</script>

</body>
</html>
